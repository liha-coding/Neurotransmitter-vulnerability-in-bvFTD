clearvars

% your results folder from the JuSpace analysis
dir_start = '/YOUR/RESULTS/FOLDER';

% find files from analysis
% indZ for group1 to group2 analysis
files = dir([dir_start, '*indZ*.mat']);
filename = [dir_start, files.name];
% load Fisher's z transformed correlation coefficients
load(filename, 'stats');
% load p-values
load(filename, 'p_exact');

% check for significance of p-values after FDR correction
p_exact_indZ = p_exact';
fdr_p_indZ = FDR(p_exact_indZ, 0.05); % retrieved from https://de.mathworks.com/matlabcentral/fileexchange/71734-fdr-false-discovery-rate

if isempty(fdr_p_indZ)==1
   fdr_p_indZ = "-";
end

% correlation coefficients
z_pat = stats.res_ind;

% data for figure
z_long = reshape(z_pat,[size(z_pat,1)*size(z_pat,2),1]);

long_second = [];
for i = 1:size(z_pat,2)
    long_second = [long_second; i*ones(size(z_pat,1),1)];
end

z_long(:,2) = long_second;

titles = {char("Fisher's z (Spearman rho)"), char("Neurotransmitter")};

% write figure data to excel
xlswrite([dir_start,'z_indZ.xlsx'], titles, 'Tabelle1', 'A1:B1');
xlswrite([dir_start,'z_indZ.xlsx'], z_long, 'Tabelle1', 'A2');

