clearvars

%% data

data = 0;

if data == 0
    folder = 'fALFF\Original_autocorrelations\PETmaps_old\Functionals_corrected_age_gender_sitedummy\';
elseif data == 1
    folder = 'Structural\Original_autocorrelations\PETmaps_old\Structurals_corrected_age_gender_TIV_sitedummy\';    
end

dir_start = ['D:\Server\Projekt 3\JuSpace\',folder];

%% Group differences (indZ)

files = dir([dir_start, 'Results_FTD_vs_HC_indZ_*.mat']);
filename = [dir_start, files.name];
load(filename, 'stats');
load(filename, 'p_exact');

p_exact_indZ = p_exact';

fdr_p_indZ = FDR(p_exact_indZ, 0.05);

if isempty(fdr_p_indZ)==1
   fdr_p_indZ = "-";
end

z_pat = stats.res_ind;

z_long = reshape(z_pat,[size(z_pat,1)*size(z_pat,2),1]);

long_second = [];
for i = 1:size(z_pat,2)
    long_second = [long_second; i*ones(size(z_pat,1),1)];
end

z_long(:,2) = long_second;

titles = {char("Fisher's z (Spearman rho)"), char("Neurotransmitter")};

xlswrite([dir_start,'z_indZ.xlsx'], titles, 'Tabelle1', 'A1:B1');
xlswrite([dir_start,'z_indZ.xlsx'], z_long, 'Tabelle1', 'A2');

